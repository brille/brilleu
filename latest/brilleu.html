

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The BrillEu class &mdash; brilleu  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/katex-math.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
        <script src="_static/katex_autorenderer.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Utilities" href="utilities.html" />
    <link rel="prev" title="Installation" href="install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> brilleu
          

          
            
            <img src="_static/brilleu.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">The <cite>BrillEu</cite> class</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">brilleu</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>The <cite>BrillEu</cite> class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/brilleu.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-brilleu.brilleu"></span><div class="section" id="the-brilleu-class">
<h1>The <cite>BrillEu</cite> class<a class="headerlink" href="#the-brilleu-class" title="Permalink to this headline">¶</a></h1>
<p>Define a class BrillEu to act as the interface between brille and Euphonic.
Thus enabling efficient interpolation of CASTEP-derived phonons at arbitrary
Q points.</p>
<dl class="py class">
<dt id="brilleu.BrillEu">
<em class="property">class </em><code class="sig-prename descclassname">brilleu.</code><code class="sig-name descname">BrillEu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">FCData</span></em>, <em class="sig-param"><span class="n">Grid</span></em>, <em class="sig-param"><span class="n">crystal</span></em>, <em class="sig-param"><span class="n">scattering_lengths</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parallel</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">emit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.BrillEu" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficient interpolation of phonon intensity at arbitrary Q points.</p>
<p>The <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/index.html" title="(in Euphonic)"><span>Euphonic</span></a> data classes can be used to, e.g., interpolate
dynamical force matrices at arbitary Q points. It can then use that
information to determine eigen values (squared excitation energy) and
eigen vectors (atom displacements) for the 3×[number of atoms] phonon
branches. Finally Q and the eigen vectors can be used to determine the
structure factors of the phonon branches, which are proportional to the
doubly-differential cross section measured by neutron scattering.</p>
<p><a class="reference external" href="https://brille.github.io/stable/index.html" title="(in brille)"><span>brille</span></a> provides classes to hold arbitrarily-shaped data at
the points of a grid filling the first irreducible Brillouin zone of the
primitive lattice reciprocal unit cell. The classes can then use linear
interpolation to estimate their held-data at points between grid-points,
the translational and rotational symmetry of the lattice to find an
equivalent first-irreducible-Brillouin-zone point, q, for any arbitrary
reciprocal space point, Q.</p>
<p>The BrillEu object must be constructed with the symmetry information of its
lattice. The symmetry operators can be read from a CASTEP file or a Hall
symbol can be read from a Phonopy summary file. In either case the symmetry
information is used to construc a first irreducible Brillouin zone which is
used to define the boundary of a <a class="reference external" href="https://brille.github.io/stable/index.html" title="(in brille)"><span>brille</span></a> grid object.
The gridded-points are then used by the Euphonic object to calculate
ωᵢ(q) and ϵᵢⱼ(q), which are placed in the brille object at their respective
grid points. When an external request is made to the BrillEu object to
calculate Sᵢ(Q) it first uses the filled brille object to interpolate ωᵢ(Q)
and ϵᵢⱼ(Q) and then converts Q and ϵᵢⱼ(Q) into Sᵢ(Q).
The more-likely use for BrillEu, however, will be in calculating S(Q,ω) in
which case ωᵢ(Q) and Sᵢ(Q) are calculated as above and then a simple
distribution (selected by the caller) is used to broaden each of the i
phonon branches before combining their intensities.</p>
<dl class="py method">
<dt id="brilleu.BrillEu.dw">
<code class="sig-name descname">dw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q_hkl</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.BrillEu.dw" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Debye-Waller factor using the Brillouin zone grid.</p>
</dd></dl>

<dl class="py method">
<dt id="brilleu.BrillEu.from_castep">
<em class="property">classmethod </em><code class="sig-name descname">from_castep</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.BrillEu.from_castep" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/force-constants.html#euphonic.force_constants.ForceConstants.from_castep" title="(in Euphonic)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">euphonic.force_constants.ForceConstants.from_castep()</span></code></a></p>
<p>Pulls <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/force-constants.html#euphonic.force_constants.ForceConstants" title="(in Euphonic)"><code class="xref py py-class docutils literal notranslate"><span class="pre">euphonic.force_constants.ForceConstants</span></code></a> from the
binary CASTEP file provided then uses custom reader to extract symmetry
operations as well.</p>
</dd></dl>

<dl class="py method">
<dt id="brilleu.BrillEu.from_forceconstants">
<em class="property">classmethod </em><code class="sig-name descname">from_forceconstants</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fc</span></em>, <em class="sig-param"><span class="n">hall</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">symmetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mesh</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.BrillEu.from_forceconstants" title="Permalink to this definition">¶</a></dt>
<dd><p>Common constructor which builds <a class="reference external" href="https://brille.github.io/stable/index.html" title="(in brille)"><span>brille</span></a> grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> (<a class="reference external" href="https://euphonic.readthedocs.io/en/stable/force-constants.html#euphonic.force_constants.ForceConstants" title="(in Euphonic)"><code class="xref py py-class docutils literal notranslate"><span class="pre">euphonic.force_constants.ForceConstants</span></code></a>) – The force constants obtained from <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/index.html" title="(in Euphonic)"><span>Euphonic</span></a></p></li>
<li><p><strong>hall</strong> (<em>str</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – A valid Hall symbol or (deprecated) Spglib Hall number encoding the
symmetry operations of the spacegroup</p></li>
<li><p><strong>symmetry</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">brille.Symmetry</span></code>, optional) – The spacegroup symmetry operations or their generators</p></li>
<li><p><strong>mesh</strong> (<em>logical</em><em>, </em><em>optional</em>) – Construct a <code class="xref py py-class docutils literal notranslate"><span class="pre">brille.BZMeshQdc</span></code> grid</p></li>
<li><p><strong>nest</strong> (<em>logical</em><em> , </em><em>optional</em>) – Construct a <code class="xref py py-class docutils literal notranslate"><span class="pre">brille.BZNestQdc</span></code> grid</p></li>
<li><p><strong>**kwds</strong> – passed to constructor of grid object and class constructor
<a class="reference internal" href="#brilleu.brilleu.BrillEu" title="brilleu.brilleu.BrillEu"><code class="xref py py-class docutils literal notranslate"><span class="pre">brilleu.brilleu.BrillEu</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#brilleu.brilleu.BrillEu" title="brilleu.brilleu.BrillEu"><code class="xref py py-class docutils literal notranslate"><span class="pre">brilleu.brilleu.BrillEu</span></code></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If both <cite>mesh</cite> and <cite>nest</cite> are not <cite>True</cite> a <code class="xref py py-class docutils literal notranslate"><span class="pre">brille.BZTrellisQdc</span></code>
will be created. This is the default behaviour.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="brilleu.BrillEu.from_phonopy">
<em class="property">classmethod </em><code class="sig-name descname">from_phonopy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">summary_name</span><span class="o">=</span><span class="default_value">'phonopy.yaml'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.BrillEu.from_phonopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/force-constants.html#euphonic.force_constants.ForceConstants.from_phonopy" title="(in Euphonic)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">euphonic.force_constants.ForceConstants.from_phonopy()</span></code></a></p>
<p>Pulls <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/force-constants.html#euphonic.force_constants.ForceConstants" title="(in Euphonic)"><code class="xref py py-class docutils literal notranslate"><span class="pre">euphonic.force_constants.ForceConstants</span></code></a> from the
Phonopy file(s) provided then pulls Hall symbol from the summary file.</p>
</dd></dl>

<dl class="py method">
<dt id="brilleu.BrillEu.s_q">
<code class="sig-name descname">s_q</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q_hkl</span></em>, <em class="sig-param"><span class="n">interpolate</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.BrillEu.s_q" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Sᵢ(Q) where Q = (q_h,q_k,q_l).</p>
</dd></dl>

<dl class="py method">
<dt id="brilleu.BrillEu.s_qw">
<code class="sig-name descname">s_qw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q_hkl</span></em>, <em class="sig-param"><span class="n">energy</span></em>, <em class="sig-param"><span class="n">p_dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.BrillEu.s_qw" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate <span class="math">\(S(\mathbf{Q},E)\)</span> including an energy linewidth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_hkl</strong> (<span class="math">\(N\times 3\)</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The positions in reciprocal lattice units where the phonon spectral
weight should be determined</p></li>
<li><p><strong>energy</strong> (<span class="math">\(N\)</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The energies at which the phonon spectral weight should be determined</p></li>
<li><p><strong>calc_bose</strong> (<em>logical</em><em>, </em><em>optional</em>) – Whether a Bose-factor correction should be applied</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default = 5 K</em>) – The temperature used in the Bose and Debye-Waller calculation</p></li>
<li><p><strong>unique_q</strong> (<em>logical</em><em>, </em><em>optional</em><em>, </em><em>default False</em>) – If <cite>True</cite> the input <cite>q_hkl</cite> are reduced to only unique vectors
before calling <a class="reference internal" href="#brilleu.brilleu.BrillEu.s_q" title="brilleu.brilleu.BrillEu.s_q"><code class="xref py py-meth docutils literal notranslate"><span class="pre">brilleu.brilleu.BrillEu.s_q()</span></code></a></p></li>
<li><p><strong>resfun</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default δ</em><em>(</em><em>ω-ωᵢ</em><em>)</em>) – (energy) resolution function used in broadening modes.
See below.</p></li>
<li><p><strong>param</strong> (float array-like (required if <cite>resfun</cite> provided)) – parameters for the broading resolution function</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Selecting the energy linewidth function:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 38%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Linewidth function</p></th>
<th class="head"><p><cite>resfun</cite> (one of)</p></th>
<th class="head"><p><cite>param</cite></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Simple Harmonic Oscillator</p></td>
<td><p><cite>‘sho’</cite>, <cite>‘s’</cite></p></td>
<td><p><cite>fwhm</cite></p></td>
</tr>
<tr class="row-odd"><td><p>Gaussian</p></td>
<td><p><cite>‘gauss’</cite>, <cite>‘g’</cite></p></td>
<td><p><cite>fwhm</cite></p></td>
</tr>
<tr class="row-even"><td><p>Lorentzian</p></td>
<td><p><cite>‘lorentz’</cite>, <cite>‘lor’</cite>, <cite>‘l’</cite></p></td>
<td><p><cite>fwhm</cite></p></td>
</tr>
<tr class="row-odd"><td><p>Voigt</p></td>
<td><p><cite>‘voi’</cite>, <cite>‘v’</cite></p></td>
<td><p><cite>[g_fwhm, l_fwhm]</cite></p></td>
</tr>
</tbody>
</table>
<p>For each linewidth function, the full name is also a valid value for
<cite>resfun</cite>, e.g., <cite>‘resfun’: ‘Simple Harmonic Oscillator’</cite>.
Functions taking a single <cite>param</cite> value will use the first element in
any non-scalar value. The Simple Harmonic Oscillator function also uses
the <cite>temperature</cite> key in p_dict to optionally include the temperature.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A vector with <span class="math">\(S(\mathbf{Q},E)\)</span></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><span class="math">\(N\)</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brilleu.BrillEu.w_q">
<code class="sig-name descname">w_q</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q_pt</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.BrillEu.w_q" title="Permalink to this definition">¶</a></dt>
<dd><p>Variant of <code class="xref py py-meth docutils literal notranslate"><span class="pre">brilleu.brilleu.BrillEu.QPointPhononModes()</span></code></p>
<p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">brilleu.brilleu.BrillEu.QPointPhononModes()</span></code> for
possible input.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Only the determined eigenvalues</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="brilleu.brilleu.BrQ">
<span id="brilleu.brilleu.BrQωε"></span><em class="property">class </em><code class="sig-prename descclassname">brilleu.brilleu.</code><code class="sig-name descname">BrQωε</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Q</span></em>, <em class="sig-param"><span class="n">ω</span></em>, <em class="sig-param"><span class="n">ε</span></em>, <em class="sig-param"><span class="n">Wd</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">T</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.brilleu.BrQ" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to a <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/qpoint-phonon-modes.html#euphonic.qpoint_phonon_modes.QpointPhononModes" title="(in Euphonic)"><code class="xref py py-class docutils literal notranslate"><span class="pre">euphonic.qpoint_phonon_modes.QpointPhononModes</span></code></a></p>
<p>This object holds the results of the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">brille.brille.BrillEu.QpointPhononModes()</span></code> calculation
in such a way that the phonon structure factor can be easily calculated.</p>
<dl class="py method">
<dt id="brilleu.brilleu.BrQ.calculate_structure_factor">
<span id="brilleu.brilleu.BrQωε.calculate_structure_factor"></span><code class="sig-name descname">calculate_structure_factor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">crystal</span></em>, <em class="sig-param"><span class="n">scattering_lengths</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.brilleu.BrQ.calculate_structure_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the one phonon inelastic neutron scattering dynamic structure factor</p>
<p>Adapted from the <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/structure-factor.html#euphonic.structure_factor.StructureFactor" title="(in Euphonic)"><code class="xref py py-class docutils literal notranslate"><span class="pre">euphonic.structure_factor.StructureFactor</span></code></a>
constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crystal</strong> (<em>euphonic.Crystal</em>) – A valid Crystal object to provide atoms, masses, and positions,
needed to produce output object</p></li>
<li><p><strong>scattering_lengths</strong> (<em>dictionary of str : float</em>) – Dictionary of spin and isotope averaged coherent scattering lengths
for each element in the structure, with lengths in fm.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://euphonic.readthedocs.io/en/stable/structure-factor.html#euphonic.structure_factor.StructureFactor" title="(in Euphonic)"><code class="xref py py-class docutils literal notranslate"><span class="pre">euphonic.structure_factor.StructureFactor</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="brilleu.brilleu.BrillEu">
<em class="property">class </em><code class="sig-prename descclassname">brilleu.brilleu.</code><code class="sig-name descname">BrillEu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">FCData</span></em>, <em class="sig-param"><span class="n">Grid</span></em>, <em class="sig-param"><span class="n">crystal</span></em>, <em class="sig-param"><span class="n">scattering_lengths</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parallel</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">emit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.brilleu.BrillEu" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficient interpolation of phonon intensity at arbitrary Q points.</p>
<p>The <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/index.html" title="(in Euphonic)"><span>Euphonic</span></a> data classes can be used to, e.g., interpolate
dynamical force matrices at arbitary Q points. It can then use that
information to determine eigen values (squared excitation energy) and
eigen vectors (atom displacements) for the 3×[number of atoms] phonon
branches. Finally Q and the eigen vectors can be used to determine the
structure factors of the phonon branches, which are proportional to the
doubly-differential cross section measured by neutron scattering.</p>
<p><a class="reference external" href="https://brille.github.io/stable/index.html" title="(in brille)"><span>brille</span></a> provides classes to hold arbitrarily-shaped data at
the points of a grid filling the first irreducible Brillouin zone of the
primitive lattice reciprocal unit cell. The classes can then use linear
interpolation to estimate their held-data at points between grid-points,
the translational and rotational symmetry of the lattice to find an
equivalent first-irreducible-Brillouin-zone point, q, for any arbitrary
reciprocal space point, Q.</p>
<p>The BrillEu object must be constructed with the symmetry information of its
lattice. The symmetry operators can be read from a CASTEP file or a Hall
symbol can be read from a Phonopy summary file. In either case the symmetry
information is used to construc a first irreducible Brillouin zone which is
used to define the boundary of a <a class="reference external" href="https://brille.github.io/stable/index.html" title="(in brille)"><span>brille</span></a> grid object.
The gridded-points are then used by the Euphonic object to calculate
ωᵢ(q) and ϵᵢⱼ(q), which are placed in the brille object at their respective
grid points. When an external request is made to the BrillEu object to
calculate Sᵢ(Q) it first uses the filled brille object to interpolate ωᵢ(Q)
and ϵᵢⱼ(Q) and then converts Q and ϵᵢⱼ(Q) into Sᵢ(Q).
The more-likely use for BrillEu, however, will be in calculating S(Q,ω) in
which case ωᵢ(Q) and Sᵢ(Q) are calculated as above and then a simple
distribution (selected by the caller) is used to broaden each of the i
phonon branches before combining their intensities.</p>
<dl class="py method">
<dt id="brilleu.brilleu.BrillEu.dw">
<code class="sig-name descname">dw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q_hkl</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.brilleu.BrillEu.dw" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Debye-Waller factor using the Brillouin zone grid.</p>
</dd></dl>

<dl class="py method">
<dt id="brilleu.brilleu.BrillEu.from_castep">
<em class="property">classmethod </em><code class="sig-name descname">from_castep</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.brilleu.BrillEu.from_castep" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/force-constants.html#euphonic.force_constants.ForceConstants.from_castep" title="(in Euphonic)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">euphonic.force_constants.ForceConstants.from_castep()</span></code></a></p>
<p>Pulls <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/force-constants.html#euphonic.force_constants.ForceConstants" title="(in Euphonic)"><code class="xref py py-class docutils literal notranslate"><span class="pre">euphonic.force_constants.ForceConstants</span></code></a> from the
binary CASTEP file provided then uses custom reader to extract symmetry
operations as well.</p>
</dd></dl>

<dl class="py method">
<dt id="brilleu.brilleu.BrillEu.from_forceconstants">
<em class="property">classmethod </em><code class="sig-name descname">from_forceconstants</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fc</span></em>, <em class="sig-param"><span class="n">hall</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">symmetry</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mesh</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nest</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.brilleu.BrillEu.from_forceconstants" title="Permalink to this definition">¶</a></dt>
<dd><p>Common constructor which builds <a class="reference external" href="https://brille.github.io/stable/index.html" title="(in brille)"><span>brille</span></a> grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc</strong> (<a class="reference external" href="https://euphonic.readthedocs.io/en/stable/force-constants.html#euphonic.force_constants.ForceConstants" title="(in Euphonic)"><code class="xref py py-class docutils literal notranslate"><span class="pre">euphonic.force_constants.ForceConstants</span></code></a>) – The force constants obtained from <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/index.html" title="(in Euphonic)"><span>Euphonic</span></a></p></li>
<li><p><strong>hall</strong> (<em>str</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – A valid Hall symbol or (deprecated) Spglib Hall number encoding the
symmetry operations of the spacegroup</p></li>
<li><p><strong>symmetry</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">brille.Symmetry</span></code>, optional) – The spacegroup symmetry operations or their generators</p></li>
<li><p><strong>mesh</strong> (<em>logical</em><em>, </em><em>optional</em>) – Construct a <code class="xref py py-class docutils literal notranslate"><span class="pre">brille.BZMeshQdc</span></code> grid</p></li>
<li><p><strong>nest</strong> (<em>logical</em><em> , </em><em>optional</em>) – Construct a <code class="xref py py-class docutils literal notranslate"><span class="pre">brille.BZNestQdc</span></code> grid</p></li>
<li><p><strong>**kwds</strong> – passed to constructor of grid object and class constructor
<a class="reference internal" href="#brilleu.brilleu.BrillEu" title="brilleu.brilleu.BrillEu"><code class="xref py py-class docutils literal notranslate"><span class="pre">brilleu.brilleu.BrillEu</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#brilleu.brilleu.BrillEu" title="brilleu.brilleu.BrillEu"><code class="xref py py-class docutils literal notranslate"><span class="pre">brilleu.brilleu.BrillEu</span></code></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If both <cite>mesh</cite> and <cite>nest</cite> are not <cite>True</cite> a <code class="xref py py-class docutils literal notranslate"><span class="pre">brille.BZTrellisQdc</span></code>
will be created. This is the default behaviour.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="brilleu.brilleu.BrillEu.from_phonopy">
<em class="property">classmethod </em><code class="sig-name descname">from_phonopy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">summary_name</span><span class="o">=</span><span class="default_value">'phonopy.yaml'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.brilleu.BrillEu.from_phonopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/force-constants.html#euphonic.force_constants.ForceConstants.from_phonopy" title="(in Euphonic)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">euphonic.force_constants.ForceConstants.from_phonopy()</span></code></a></p>
<p>Pulls <a class="reference external" href="https://euphonic.readthedocs.io/en/stable/force-constants.html#euphonic.force_constants.ForceConstants" title="(in Euphonic)"><code class="xref py py-class docutils literal notranslate"><span class="pre">euphonic.force_constants.ForceConstants</span></code></a> from the
Phonopy file(s) provided then pulls Hall symbol from the summary file.</p>
</dd></dl>

<dl class="py method">
<dt id="brilleu.brilleu.BrillEu.s_q">
<code class="sig-name descname">s_q</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q_hkl</span></em>, <em class="sig-param"><span class="n">interpolate</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.brilleu.BrillEu.s_q" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Sᵢ(Q) where Q = (q_h,q_k,q_l).</p>
</dd></dl>

<dl class="py method">
<dt id="brilleu.brilleu.BrillEu.s_qw">
<code class="sig-name descname">s_qw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q_hkl</span></em>, <em class="sig-param"><span class="n">energy</span></em>, <em class="sig-param"><span class="n">p_dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.brilleu.BrillEu.s_qw" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate <span class="math">\(S(\mathbf{Q},E)\)</span> including an energy linewidth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_hkl</strong> (<span class="math">\(N\times 3\)</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The positions in reciprocal lattice units where the phonon spectral
weight should be determined</p></li>
<li><p><strong>energy</strong> (<span class="math">\(N\)</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The energies at which the phonon spectral weight should be determined</p></li>
<li><p><strong>calc_bose</strong> (<em>logical</em><em>, </em><em>optional</em>) – Whether a Bose-factor correction should be applied</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default = 5 K</em>) – The temperature used in the Bose and Debye-Waller calculation</p></li>
<li><p><strong>unique_q</strong> (<em>logical</em><em>, </em><em>optional</em><em>, </em><em>default False</em>) – If <cite>True</cite> the input <cite>q_hkl</cite> are reduced to only unique vectors
before calling <a class="reference internal" href="#brilleu.brilleu.BrillEu.s_q" title="brilleu.brilleu.BrillEu.s_q"><code class="xref py py-meth docutils literal notranslate"><span class="pre">brilleu.brilleu.BrillEu.s_q()</span></code></a></p></li>
<li><p><strong>resfun</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default δ</em><em>(</em><em>ω-ωᵢ</em><em>)</em>) – (energy) resolution function used in broadening modes.
See below.</p></li>
<li><p><strong>param</strong> (float array-like (required if <cite>resfun</cite> provided)) – parameters for the broading resolution function</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Selecting the energy linewidth function:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37%" />
<col style="width: 38%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Linewidth function</p></th>
<th class="head"><p><cite>resfun</cite> (one of)</p></th>
<th class="head"><p><cite>param</cite></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Simple Harmonic Oscillator</p></td>
<td><p><cite>‘sho’</cite>, <cite>‘s’</cite></p></td>
<td><p><cite>fwhm</cite></p></td>
</tr>
<tr class="row-odd"><td><p>Gaussian</p></td>
<td><p><cite>‘gauss’</cite>, <cite>‘g’</cite></p></td>
<td><p><cite>fwhm</cite></p></td>
</tr>
<tr class="row-even"><td><p>Lorentzian</p></td>
<td><p><cite>‘lorentz’</cite>, <cite>‘lor’</cite>, <cite>‘l’</cite></p></td>
<td><p><cite>fwhm</cite></p></td>
</tr>
<tr class="row-odd"><td><p>Voigt</p></td>
<td><p><cite>‘voi’</cite>, <cite>‘v’</cite></p></td>
<td><p><cite>[g_fwhm, l_fwhm]</cite></p></td>
</tr>
</tbody>
</table>
<p>For each linewidth function, the full name is also a valid value for
<cite>resfun</cite>, e.g., <cite>‘resfun’: ‘Simple Harmonic Oscillator’</cite>.
Functions taking a single <cite>param</cite> value will use the first element in
any non-scalar value. The Simple Harmonic Oscillator function also uses
the <cite>temperature</cite> key in p_dict to optionally include the temperature.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A vector with <span class="math">\(S(\mathbf{Q},E)\)</span></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><span class="math">\(N\)</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brilleu.brilleu.BrillEu.w_q">
<code class="sig-name descname">w_q</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q_pt</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.brilleu.BrillEu.w_q" title="Permalink to this definition">¶</a></dt>
<dd><p>Variant of <code class="xref py py-meth docutils literal notranslate"><span class="pre">brilleu.brilleu.BrillEu.QPointPhononModes()</span></code></p>
<p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">brilleu.brilleu.BrillEu.QPointPhononModes()</span></code> for
possible input.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Only the determined eigenvalues</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="brilleu.brilleu.getBrillEuObj">
<code class="sig-prename descclassname">brilleu.brilleu.</code><code class="sig-name descname">getBrillEuObj</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brilleu.brilleu.getBrillEuObj" title="Permalink to this definition">¶</a></dt>
<dd><p>For loading local directory or fetching from remote repository into a BrillEu object</p>
<p>See <a class="reference internal" href="utilities.html#brilleu.utilities.getObjType" title="brilleu.utilities.getObjType"><code class="xref py py-func docutils literal notranslate"><span class="pre">brilleu.utilities.getObjType()</span></code></a> for details.</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="utilities.html" class="btn btn-neutral float-right" title="Utilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Greg Tucker

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>